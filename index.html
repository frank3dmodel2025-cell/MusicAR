<!-- 
  WebAR Image Tracking con AR.js y A-Frame
  
  Este ejemplo utiliza AR.js para el rastreo de una imagen específica (Trigger Image) 
  y A-Frame para renderizar un objeto 3D (una caja que rota) sobre esa imagen 
  cuando es detectada por la cámara.
-->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAR - Rastreo de Imagen</title>
    <!-- Carga de la librería A-Frame (para 3D) -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <!-- Carga de la librería AR.js (para Realidad Aumentada) -->
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.0/aframe/build/aframe-ar-nft.js"></script>

    <style>
        /* Estilos básicos para asegurar que la escena de A-Frame ocupe toda la pantalla */
        body { margin: 0; overflow: hidden; }
        .info-box {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            font-family: sans-serif;
            font-size: 14px;
            text-align: center;
            z-index: 1000;
        }
    </style>
</head>
<body>

    <!-- 
      Contenedor de información para el usuario 
      IMPORTANTE: La URL de la imagen de rastreo debe imprimirse o mostrarse en otra pantalla.
    -->
    <div class="info-box">
        <h3>Instrucciones de WebAR (Simulación Artivive)</h3>
        <p>1. Permite el acceso a la cámara.</p>
        <p>2. Abre esta imagen en otro dispositivo o imprímela:</p>
        <p><a href="https://i.ibb.co/68v8z7y/trigger-image.png" target="_blank" style="color: yellow;">IMAGEN DE DISPARO AQUÍ</a></p>
        <p>3. Apunta la cámara de este dispositivo a la imagen para ver el cubo.</p>
        <p>4. Mueve tu dispositivo para ver cómo el cubo se mantiene fijo en la imagen.</p>
    </div>

    <!-- 
      a-scene: Define la escena de Realidad Aumentada.
      embedded: Indica que la escena debe estar dentro del HTML.
      arjs: Configuración de AR.js
          - source: pattern: indica que la fuente es la cámara (por defecto).
          - trackingMethod: best (usa los mejores métodos de rastreo disponibles).
          - sourceType: webcam (usa la cámara del dispositivo).
          - debug: false (no muestra información de depuración).
          - initializationDelay: 0 (inicia inmediatamente).
          - nft: Activa el rastreo de imágenes (NFT - Natural Feature Tracking) 
    -->
    <a-scene 
        embedded 
        arjs='sourceType: webcam; trackingMethod: best; debugUIEnabled: false; initializationDelay: 0; nft: url(https://arjs-cors-proxy.s3.eu-central-1.amazonaws.com/nft/artivive-trigger-image);'
    >

        <!-- 
          a-nft: Este es el elemento clave de rastreo de imágenes.
          type: nft indica rastreo de imágenes naturales.
          url: Es la ubicación del archivo de rastreo (el .fset y .iset generado por AR.js a partir de la imagen).
               NOTA: Para que funcione, necesitamos un proxy que cargue los archivos pre-procesados, 
               como el que se usa aquí (un marcador de prueba de Artivive).
          
          IMPORTANTE: El contenido dentro de a-nft SOLO es visible cuando la imagen es detectada.
        -->
        <a-nft 
            type='nft' 
            url='https://arjs-cors-proxy.s3.eu-central-1.amazonaws.com/nft/artivive-trigger-image'
            smooth='true' 
            smoothTime='0.1' 
            smoothThreshold='5'
        >
            <!-- Objeto 3D que aparecerá sobre la imagen rastreada -->
            <a-box 
                position='0 0.5 0' 
                scale='0.5 0.5 0.5' 
                rotation='0 0 0' 
                color='#F00' 
                material='opacity: 0.8; metalness: 0.5;'
                animation="property: rotation; to: 0 360 0; loop: true; dur: 3000; easing: linear"
            >
                <!-- Texto superpuesto al cubo -->
                <a-text 
                    value="¡AR Activo!" 
                    align="center" 
                    width="2.5" 
                    color="#FFF"
                    position="0 0.6 0" 
                    rotation="-90 0 0"
                ></a-text>
            </a-box>

        </a-nft>

        <!-- a-entity: Representa la cámara del dispositivo -->
        <a-entity camera></a-entity>

    </a-scene>
</body>
</html>
